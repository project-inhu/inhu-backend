global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    monitor: 'prod-monitor'

rule_files:
  - 'config/rule.yml'

scrape_configs:
  - job_name: 'ec2-infra'
    scrape_interval: 10s
    static_configs:
      - targets:
          - 'postgres-exporter:9187'
          - 'redis-exporter:9121'
          - 'node-exporter:9100'
          - 'prometheus:9090'
    relabel_configs:
      - source_labels: [__address__]
        regex: '(.*)'
        target_label: instance
        replacement: '$1:ec2'

  - job_name: 'ec2-app'
    static_configs:
      - targets:
          - 'api.inhu.co.kr:3000'
          - 'api-admin.inhu.co.kr:3001'
    metrics_path: '/metrics'
    relabel_configs:
      - source_labels: [__address__]
        regex: '(.+):.*'
        target_label: instance
        replacement: '$1:ec2-app'
